<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ page.title }} | {{ site.title }}</title>

  <link rel="stylesheet" href="{{ '/assets/styles.css' | relative_url }}">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans&display=swap" rel="stylesheet">
</head>
<body>

  <header>
    <div class="wrapper">
      <nav class="site-nav">
        <a href="/lab/index.html">🏠Home</a> |
        <a href="/lab/courses/all-courses/">📘Courses</a> |
        <a href="/lab/projects/all-projects/">📂Projects</a> |
        <a href="/lab/news/all-news/">📌News</a>
      </nav>
    </div>
  </header>

  <main class="page-content" aria-label="Content">
    <div class="wrapper">

      <article class="post">
        <header class="post-header">
          <h2 class="post-title">{{ page.title }}</h2>
        </header>

        <div class="meta">
          {% if page.deadline %}
            ⏱ <strong>Deadline:</strong> {{ page.deadline }}<br>
          {% endif %}
          {% if page.level %}
            📚 <strong>Level:</strong> {{ page.level }}
          {% endif %}
        </div>

        <div class="post-content">
          {{ content }}
        </div>
      </article>

      <hr>

{% comment %} Получить список уроков, исключив те, у которых exclude_from_course: true {% endcomment %}
{% assign lessons = site.courses | where_exp: "item", "item.exclude_from_course != true" | sort: "order" %}
{% assign total = lessons | size %}

{% assign current_number = nil %}
{% assign prev = nil %}
{% assign next = nil %}
{% assign prev_index = nil %}
{% assign next_index = nil %}
{% assign found = false %}

{% for lesson in lessons %}
  {% if lesson.url == page.url and found == false %}
    {% assign current_number = forloop.index %}
    {% assign prev_index = forloop.index0 | minus: 1 %}
    {% assign next_index = forloop.index0 | plus: 1 %}
    {% assign found = true %}
  {% endif %}
{% endfor %}

{% if prev_index != nil and prev_index >= 0 %}
  {% assign prev = lessons[prev_index] %}
{% endif %}
{% if next_index != nil and next_index < total %}
  {% assign next = lessons[next_index] %}
{% endif %}

{% if total and current_number %}
  <div class="progress-container">
    <div class="progress-bar" style="width: {{ current_number | times: 100 | divided_by: total }}%">
      {{ current_number }}/{{ total }}
    </div>
  </div>
{% endif %}

<div class="nav">
  {% if prev %}
    ← <a class="button" href="{{ prev.url | relative_url }}">PREV- {{ prev.title }}</a>
  {% endif %}

  {% if next %}
    <a class="button" href="{{ next.url | relative_url }}">NEXT- {{ next.title }}</a> →
  {% endif %}
</div>



    </div>
  </main>

  <footer>
    <div class="wrapper">
      <!-- 
        <p>© {{ site.title }} — {{ site.time | date: "%Y" }}</p>
      -->
    </div>
  </footer>

</body>
</html>
